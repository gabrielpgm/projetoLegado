<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Cliente</title>
</head>

<body>
    <h1>Detalhes do Cliente</h1>

    <!-- Verifica se estamos no modo de visualização ou edição -->
    {% if modo == 'visualizar' %}
    <p><strong>Número Identificador:</strong> {{ cliente.numero_identificador }}</p>
    <p><strong>Nome:</strong> {{ cliente.nome }}</p>
    <p><strong>CPF:</strong> {{ cliente.cpf }}</p>

    <h3>Documentos</h3>

    <!-- Verifica se existe documentos antes de tentar acessar -->
    {% if cliente.documentos %}
    <p><strong>Identidade:</strong> 
        {% if cliente.documentos.identidade and cliente.documentos.identidade.arquivo %}
            <a href="{{ url_for('static', filename=cliente.documentos.identidade.arquivo) }}" target="_blank">Visualizar</a>
            <a href="{{ url_for('baixar_arquivo', tipo='identidade', arquivo=cliente.documentos.identidade.arquivo.split('/')[-1]) }}">Baixar</a>
        {% else %}
            Não enviado
        {% endif %}
    </p>
    
    <p><strong>CNH:</strong> 
        {% if cliente.documentos.cnh and cliente.documentos.cnh.arquivo %}
            <a href="{{ url_for('static', filename=cliente.documentos.cnh.arquivo) }}" target="_blank">Visualizar</a>
            <a href="{{ url_for('baixar_arquivo', tipo='cnh', arquivo=cliente.documentos.cnh.arquivo.split('/')[-1]) }}">Baixar</a>
        {% else %}
            Não enviado
        {% endif %}
    </p>
    
    <p><strong>Comprovante de Endereço:</strong> 
        {% if cliente.documentos.comprovante_endereco and cliente.documentos.comprovante_endereco.arquivo %}
            <a href="{{ url_for('static', filename=cliente.documentos.comprovante_endereco.arquivo) }}" target="_blank">Visualizar</a>
            <a href="{{ url_for('baixar_arquivo', tipo='comprovante_endereco', arquivo=cliente.documentos.comprovante_endereco.arquivo.split('/')[-1]) }}">Baixar</a>
        {% else %}
            Não enviado
        {% endif %}
    </p>
    
    <p><strong>Outros:</strong> 
        {% if cliente.documentos.outros and cliente.documentos.outros.arquivo %}
            <a href="{{ url_for('static', filename=cliente.documentos.outros.arquivo) }}" target="_blank">Visualizar</a>
            <a href="{{ url_for('baixar_arquivo', tipo='outros', arquivo=cliente.documentos.outros.arquivo.split('/')[-1]) }}">Baixar</a>
        {% else %}
            Não enviado
        {% endif %}
    </p>
    

    <p><strong>Comentário Comprovante de Endereço:</strong> {{ cliente.documentos.comprovante_endereco.comentario }}</p>

    <p><strong>Outros:</strong>
        {% if cliente.documentos.outros and cliente.documentos.outros.arquivo %}
        <a href="{{ url_for('static', filename=cliente.documentos.outros.arquivo) }}" target="_blank">Visualizar</a>
        <a
            href="{{ url_for('baixar_arquivo', tipo='outros', numero_identificador=cliente.numero_identificador) }}">Baixar</a>
        {% else %}
        Não enviado
        {% endif %}
    </p>
    <p><strong>Comentário Outros:</strong> {{ cliente.documentos.outros.comentario }}</p>
    {% else %}
    <p>Nenhum documento enviado.</p>
    {% endif %}

    <!-- Botão para voltar ao dashboard -->
    <form action="/busca_cliente" method="GET">
        <button type="submit">Voltar</button>
    </form>

    <!-- Link para editar cliente -->
    <form action="{{ url_for('editar_cliente', numero_identificador=cliente.numero_identificador) }}" method="GET">
        <button type="submit">Editar Cliente</button>
    </form>

    {% elif modo == 'editar' %}
    <form action="{{ url_for('editar_cliente', numero_identificador=cliente.numero_identificador) }}" method="POST">
        <label for="numero_identificador">Número Identificador:</label>
        <input type="text" id="numero_identificador" name="numero_identificador"
            value="{{ cliente.numero_identificador }}" disabled><br><br>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" value="{{ cliente.nome }}" required><br><br>

        <label for="cpf">CPF:</label>
        <input type="text" id="cpf" name="cpf" value="{{ cliente.cpf }}" required><br><br>

        <!-- Verifica se existe documentos antes de tentar acessar -->
        {% if cliente.documentos %}
        <label for="comentario_identidade">Comentário Identidade:</label>
        <input type="text" id="comentario_identidade" name="comentario_identidade"
            value="{{ cliente.documentos.identidade.comentario }}"><br><br>
        {% else %}
        <p>Nenhuma informação de documentos disponível para edição.</p>
        {% endif %}

        <button type="submit">Salvar</button>
    </form>

    <!-- Botão para voltar ao modo de visualização -->
    <form action="{{ url_for('visualizar_cliente', numero_identificador=cliente.numero_identificador) }}" method="GET">
        <button type="submit">Cancelar</button>
    </form>
    {% endif %}
</body>

</html>